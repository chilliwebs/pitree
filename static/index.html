<!DOCTYPE html>
<html>

<head>
    <title>PiTree</title>
    <style>
        #update {
            width: 2em;
            height: 2em;
            vertical-align: middle;
            cursor: pointer;
        }
    </style>
    <script>
        function setMode(no) {
            fetch('/mode?no=' + no).then((resp) => {
                window.location.reload();
            });
        }

        window.onload = async function () {
            document.getElementById('update').onclick = function () {
                fetch('/update').then((resp) => {
                    window.location.reload();
                });
            }

            document.getElementById('mode0').onclick = function () {
                setMode(0);
            }
            document.getElementById('mode1').onclick = function () {
                setMode(1);
            }
            document.getElementById('mode2').onclick = function () {
                setMode(2);
            }

            fetch('/ver').then(async (ver) => {
                var version = await ver.text();
                document.getElementById('ver').innerText = version;
                document.title = "PiTree v" + version;
            });

            setInterval(() => {
                Promise.all([
                    fetch('/git').then((g) => g.text()),
                    fetch('/git-remote').then((g) => g.text())
                ]).then((v) => {
                    if (v.length == 2 && v[0] != v[1]) {
                        document.getElementById('update').style.display = 'inline';
                    }
                });
            }, 30000);
        }
    </script>
</head>

<body>
    <h3>PiTree v<span id="ver">loading...</span> <img id="update" title="updates avalible" style="display: none;"
            src="update.png" /></h3>
    <div>Modes:</div>
    <button id="mode0">Warm</button><button id="mode1">White</button><button id="mode2">Random</button>
</body>

</html>